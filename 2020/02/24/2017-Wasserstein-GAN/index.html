<!DOCTYPE html>

<html lang="zh">
    <head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <!--
        © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
        Version: 1.3.2
    -->
    <script>
window.lsVersion = "1.3.2",
window.oldVersion = [
    
        
            "0.2.0","0.0.1","0.1.0","1.0.0","1.0.1","1.1.0","1.1.1","1.2.0","1.3.0"
        
    
]
</script>

    <!-- ### DNS Prefetch ### -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->







<!-- analytics -->








    <!-- ### Preload ### -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<!-- Title -->
<title>WGAN:Wasserstein GAN | 幻华&#39;s Blog</title>

<!-- favicon -->
<!-- Favicons -->

    <link rel="shortcut icon" type="image/ico" href="/img/cbhq3-nfw26-006.ico">






<!-- Android Chrome Color -->



<meta name="format-detection" content="telephone=no">

<!-- Description -->
<meta name="description" content="

1. Wasserstein GAN
1.1. 总结
">

<!-- Keywords -->
<meta name="keywords" content=", 深度学习, 论文阅读">

<!-- Disable Fucking Bloody Baidu Tranformation -->
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

    <!-- ### Import File ### -->
    
        <!-- spectre.css -->

    <link rel="stylesheet" href="/lib/spectre/spectre.min.css">


<style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style>

<!-- style.css -->

    <link rel="stylesheet" href="/css/style.min.css">









    <!-- Prettify Theme -->
    
    
        <link rel="stylesheet" href="/css/highlight/github.min.css">
    



    

    <!-- ### Site Verification ### -->
    


    <!-- ### RSS ### -->
    
    
        <link rel="alternate" type="application/atom+xml" href="/atom.xml">
    


    <!-- ### WebApp ### -->
    <meta name="mobile-web-app-capable" content="yes">
<meta name="application-name" content="幻华&#39;s Blog">
<meta name="msapplication-starturl" content="http://www.zkhweb.top">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="幻华&#39;s Blog">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Manifest Import -->

<!-- Open Search -->


    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="WGAN:Wasserstein GAN | 幻华&#39;s Blog">
<meta property="og:site_name" content="幻华&#39;s Blog">

<meta property="og:locale" content="zh">

<meta property="og:url" content="http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/">
<meta property="og:image" content="http://www.zkhweb.top/img/cbhq3-nfw26-006.ico">

<meta property="og:description" content="

1. Wasserstein GAN
1.1. 总结
">

<meta name="twitter:card" content="summary">


    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2020-02-24T12:43:09.000Z">
    <meta property="article:modified_time" content="2020-02-24T12:43:09.000Z">
    <meta property="article:author" content="幻华(Zkher)">
    <meta property="og:article:tag" content=", 深度学习, 论文阅读"> 





    <!-- ### Analytics ### -->
    








    <!-- ### Canonical link ### -->
    <link rel="canonical" href="http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/">

    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/",
    "@type": "BlogPosting",
    "logo": "http://www.zkhweb.top/img/cbhq3-nfw26-006.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/"
    },
    "headline": "WGAN:Wasserstein GAN | 幻华&#39;s Blog",
    
    "image": {
        "@type": "ImageObject",
        "url": "http://www.zkhweb.top/img/cbhq3-nfw26-006.ico"
    },
    
    "datePublished": "2020-02-24T12:43:09.000Z",
    "dateModified": "2020-03-01T13:59:41.964Z",
    "author": {
        "@type": "Person",
        "name": "幻华(Zkher)",
        "image": {
            "@type": "ImageObject",
            "url": "http://www.zkhweb.top/img/my.jpg"
        },
        "description": "Hi, nice to meet you."
    },
    "publisher": {
        "@type": "Organization",
        "name": "幻华&#39;s Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "http://www.zkhweb.top/img/cbhq3-nfw26-006.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "http://www.zkhweb.top/search/?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": ", 深度学习, 论文阅读",
    "description": "

1. Wasserstein GAN
1.1. 总结
"
}
</script>



    <!-- ### Custom Head ### --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    


</head>

    <body>
        

            

            <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">幻华&#39;s Blog</a></h1>

    <p class="text-center header-slogan">
        
            
                Hi, nice to meet you.
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">首页</a>
    
    
        <a href="/archives/" class="navbar-link">归档</a>
    
    
        <a href="/search/" class="navbar-link">搜索</a>
    
    
        <a href="/about/" class="navbar-link">关于</a>
    
        <a href="/tag/" class="navbar-link">标签</a>
    
        <a href="/gallery/" class="navbar-link">画廊</a>
    
        <a href="/links/" class="navbar-link">友链</a>
    
        <a href="/en/" class="navbar-link">英语</a>
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">分享</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=幻华's Blog&url=http://www.zkhweb.top&pic=http://www.zkhweb.top/img/cbhq3-nfw26-006.ico&searchPic=false&style=simple" target="_blank" rel="noopener noreferrer nofollow">分享到微博</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=幻华's Blog&url=http://www.zkhweb.top&via=幻华(Zkher)" target="_blank" rel="noopener noreferrer nofollow">分享到 Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.zkhweb.top" target="_blank" rel="noopener noreferrer nofollow">分享到 Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=http://www.zkhweb.top" target="_blank" rel="noopener noreferrer nofollow">分享到 Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://www.zkhweb.top&title=WGAN:Wasserstein GAN" target="_blank" rel="noopener noreferrer nofollow">分享到 LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=幻华's Blog&title=WGAN:Wasserstein GAN&summary=&pics=http://www.zkhweb.top/img/cbhq3-nfw26-006.ico&url=http://www.zkhweb.top" target="_blank" rel="noopener noreferrer nofollow"> 分享到 QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=http://www.zkhweb.top&text=WGAN:Wasserstein GAN" target="_blank" rel="noopener noreferrer nofollow">分享到 Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAACUCAAAAABQV18IAAAB2UlEQVR42u3ayw7CMAxE0f7/T8O2SLFnXLqIndsNIPo4SCGxHV+fDY8LFChQoBaoKzmy739utrjm/uo8B9Qs1HLQLVD3z+r81fvsOaDmoaLBqt5H30XXpc8BdQRKgdSECgpUNNlF50UTYvTjQJ2DShdKscBGwWF0v7+jBFDbo1Ti8Nbrq9kMqG1RsuggEgY3QXi16gJqa1SWRKrArbJYq8kY1BxUlgQ4yaWaIKMkQk6eoNqinKJqNOjVZ4W1I09Q7VBOMVYlCNG5atEGNRelimBPirJusQTULNTTYM/5o2QL9xILagxKLcJOsBb9CHfwg5qFcoqlatCrQE4NclDzUJUbuc04TlAIah7KGaAVXGUCLkWeoNqgqhNlpXFQJQ32jgOoVqhKk1Z1E8lt1AE1H6WCfzcpcDYt7YEOqh0qw1Q2kJzFObonqBmobIOnWrRwF+9SIRZUS1S12V01DDrXgZqLypJHt6nZTUplMwaoESjZvGcWwJzNAJmoghqBcgunKpBzJ9l0kgY1BvWkQOEU1ZyimdVpBqol6o0BfpkHqLNRqjk1SzZUcw6os1HZQypFjr8KsaBaoSoNfk6xI1uArYZmUK1RTrG0VKh4WrwFNQK10wEKFChQt+MLt+7Q4NieresAAAAASUVORK5CYII=" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
        <a href="/atom.xml" target="_blank" class="navbar-link">RSS</a>
    
</nav>
</header>

            
    <!-- ## Post ## -->
    
    


<div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">WGAN:Wasserstein GAN</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/my.jpg" src="/img/suka-lazyload.gif" alt="幻华(Zkher)'s Avatar">
        <span>2020-02-24</span>
        
            <span class="suka-devide-dot"></span>
            <a class="category-link" href="/categories/深度学习论文阅读/">深度学习论文阅读</a>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">分享本文</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=WGAN:Wasserstein GAN&url=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/&pic=http://www.zkhweb.top/img/cbhq3-nfw26-006.ico&searchPic=false&style=simple" target="_blank" rel="noopener noreferrer nofollow">分享到微博</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=WGAN:Wasserstein GAN&url=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/&via=幻华(Zkher)" target="_blank" rel="noopener noreferrer nofollow">分享到 Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/" target="_blank" rel="noopener noreferrer nofollow">分享到 Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/" target="_blank" rel="noopener noreferrer nofollow">分享到 Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/&title=幻华's Blog" target="_blank" rel="noopener noreferrer nofollow">分享到 LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=幻华's Blog&title=幻华's Blog&summary=&pics=http://www.zkhweb.top/img/cbhq3-nfw26-006.ico&url=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/" target="_blank" rel="noopener noreferrer nofollow"> 分享到 QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/&text=幻华's Blog" target="_blank" rel="noopener noreferrer nofollow">分享到 Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAACUCAAAAABQV18IAAAB2UlEQVR42u3ayw7CMAxE0f7/T8O2SLFnXLqIndsNIPo4SCGxHV+fDY8LFChQoBaoKzmy739utrjm/uo8B9Qs1HLQLVD3z+r81fvsOaDmoaLBqt5H30XXpc8BdQRKgdSECgpUNNlF50UTYvTjQJ2DShdKscBGwWF0v7+jBFDbo1Ti8Nbrq9kMqG1RsuggEgY3QXi16gJqa1SWRKrArbJYq8kY1BxUlgQ4yaWaIKMkQk6eoNqinKJqNOjVZ4W1I09Q7VBOMVYlCNG5atEGNRelimBPirJusQTULNTTYM/5o2QL9xILagxKLcJOsBb9CHfwg5qFcoqlatCrQE4NclDzUJUbuc04TlAIah7KGaAVXGUCLkWeoNqgqhNlpXFQJQ32jgOoVqhKk1Z1E8lt1AE1H6WCfzcpcDYt7YEOqh0qw1Q2kJzFObonqBmobIOnWrRwF+9SIRZUS1S12V01DDrXgZqLypJHt6nZTUplMwaoESjZvGcWwJzNAJmoghqBcgunKpBzJ9l0kgY1BvWkQOEU1ZyimdVpBqol6o0BfpkHqLNRqjk1SzZUcw6os1HZQypFjr8KsaBaoSoNfk6xI1uArYZmUK1RTrG0VKh4WrwFNQK10wEKFChQt+MLt+7Q4NieresAAAAASUVORK5CYII=" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                            <div id="post-toc">
                                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">1.</span> <span class="post-toc-text">1. Wasserstein GAN</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.1. 总结</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">1.2. 引言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">1.3. 不同的距离定义</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">1.4. Wasserstein GAN</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">1.5. 实验结果</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">2.</span> <span class="post-toc-text">2. 总结</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#undefined"><span class="post-toc-number">3.</span> <span class="post-toc-text">3. 参考资料</span></a></li></ol>
                            </div>
                        
                    
                    <article id="post-content">
                        <!-- toc -->
<ul>
<li><a href="#1-wasserstein-gan">1. Wasserstein GAN</a><ul>
<li><a href="#11-总结">1.1. 总结</a></li>
<li><a href="#12-引言">1.2. 引言</a></li>
<li><a href="#13-不同的距离定义">1.3. 不同的距离定义</a></li>
<li><a href="#14-wasserstein-gan">1.4. Wasserstein GAN</a></li>
<li><a href="#15-实验结果">1.5. 实验结果</a></li>
</ul>
</li>
<li><a href="#2-总结">2. 总结</a></li>
<li><a href="#3-参考资料">3. 参考资料</a></li>
</ul>
<!-- tocstop -->
<hr>
<h1><span id="1-wasserstein-gan">1. Wasserstein GAN</span></h1><blockquote>
<p>arXiv:1701.07875 [cs, stat]<br>tensorflow2代码：<a href="https://github.com/zhangkaihua88/ML_Paper" target="_blank" rel="noopener">https://github.com/zhangkaihua88/ML_Paper</a></p>
</blockquote>
<hr>
<h2><span id="11-总结">1.1. 总结</span></h2><p>一句话解释：W距离就是在最优路径规划下把生成拉向真实的最小消耗。</p>
<ul>
<li><p>要解决什么问题</p>
<ul>
<li>判别器越好，生成器梯度消失越严重</li>
<li>判别器越好的情况下，生成的模型多样性不够</li>
<li><p>训练困难，生成器和判别器的loss无法指示训练进程。</p>
<p>原始GAN的最小化loss等价于最小化生成器和判别器的JS散度和KL散度，当生成器数据和判别器数据无重叠时或者重叠可忽略时，无论相距多远,JS散度都是常数log2，经公式计算最终导致梯度为0，即梯度消失，Wasserstein距离优越性在于即便两个部分没有重叠，W距离仍能够反映远近。</p>
</li>
</ul>
</li>
<li><p>用什么方法解决<br>  <img src="https://image.zkhweb.top/20200213234842.png" alt="20200213234842.png"></p>
<ul>
<li>判别器最后一层去掉sigmoid</li>
<li>生成器和判别器的loss不取log</li>
<li>每次更新判别器的参数之后把它们的绝对值截断到不超过一个固定常数c，即Lipschitz限制</li>
<li>不要用基于动量的优化算法（包括momentum和Adam），推荐RMSProp，SGD也行</li>
</ul>
</li>
<li><p>优势</p>
<ul>
<li>将GAN的训练过程，也就是loss指示了训练进程</li>
<li>解决了生成样本的多样性的问题</li>
<li>使用DCGAN的网络结构，不需要重新设计新的网络结构</li>
</ul>
</li>
<li>还存在什么问题<br>clipx项</li>
</ul>
<hr>
<h2><span id="12-引言">1.2. 引言</span></h2><p>$\mathbb{P}_r$ ==&gt; 概率分布<br>$P_r$ ==&gt; 概率密度</p>
<p>非监督式学习</p>
<p>学习一个概率分布，通常我们是学习这个分布的概率密度函数，假设概率密度函数存在，且由多个参数组成即$\left(P_{\theta}\right)_{\theta \in \mathbb{R}^{d}}$，已知该分布下点集为$\left\{x^{(i)}\right\}_{i=1}^{m}$,那么认为这些点既然出现了，就是概率最大的（相当于极大似然的思想）。问题就变成了求解使得</p>
<script type="math/tex; mode=display">
\max _{\theta \in \mathbb{R}^{d}} \frac{1}{m} \sum_{i=1}^{m} \log P_{\theta}\left(x^{(i)}\right)</script><p>如果实际的资料分布$\mathbb{P}_r$提供机率密度，而$\mathbb{P}_\theta$是参数化的机率密度$P_\theta$，然后，两个资料分布渐近，这相当于最小化Kullback-Leibler divergence(KL-Divergence) $KL(\mathbb{P}_r||\mathbb{P}_\theta)$</p>
<p>但是在现实生活中，处理的分布的支撑集都是低位流形的。两个分布的重叠部分测度为0，那么KL散度就没办法衡量了</p>
<p>典型的纠正办法（不可取），就是给模型的分布加一个有很大宽度的高斯分布，使得模型的分布覆盖所有样本，但是这也造成了生成图像时产生了非常大噪声。</p>
<p>相比估计$\mathbb{P}_r$的概率密度，且这个密度函数还不一定存在，使用另一种方法$g_{\theta}: \mathcal{Z} \rightarrow \mathcal{X}$, $Z$为随机变量，概率密度为$p(z)$,通过改变$\theta$使得分布$\mathbb{P}_\theta$接近于真实分布$\mathbb{P}_r$</p>
<ul>
<li>与密度不同，可以表示局限于低维流形的分布</li>
<li>容易生成样本的能力通常比知道密度的数值有用（例如，在考虑给定输入图像的情况下，当考虑输出图像的条件分布时，在图像超分辨率或语义分割中）。 </li>
</ul>
<p>通常，很难在给定任意高维密度的情况下生成样本</p>
<p>本文，致力于测量两种分布之间距离的不同方法，或等效的定义距离或散度<br><strong>这种距离最重要的不同时对概率分布收敛的影响程度</strong></p>
<p><strong>分布收敛定义</strong>：距离或散度$\rho\left(\mathbb{P}_{\theta}, \mathbb{P}_{r}\right)$，分布序列$\left(\mathbb{P}_{t}\right)_{t \in \mathbb{N}}$收敛当且仅当存在一分布$\mathbb{P}_\infty$使得$\rho\left(\mathbb{P}_{t}, \mathbb{P}_{\infty}\right)$取域0.取决于距离的精确度</p>
<p><strong>连续的定义</strong>：如果参数$\theta_t$收敛为$\theta$时，那么分布$\mathbb{P}_{\theta_d}$就收敛到$\mathbb{P}_{\theta}$</p>
<p>分布$\mathbb{P}_{\theta_d}$是否收敛<strong>依赖于选择计算距离的方法</strong>，之所以给出连续的定义，是想说如果损失函数$\theta \mapsto \rho\left(\mathbb{P}_{\theta}, \mathbb{P}_{r}\right)$连续等同于$\theta \mapsto \rho\left(\mathbb{P}_{\theta}\right)$连续</p>
<ul>
<li>Section 2 各种距离的比较</li>
<li>Section 3 应用EM定义WGAN</li>
<li>Section 4 WGAN实战</li>
</ul>
<hr>
<h2><span id="13-不同的距离定义">1.3. 不同的距离定义</span></h2><p>$\mathcal{X}$ ==&gt; compact metric set(像的空间[0,1]$^d$)<br>$\sum$ ==&gt; $\mathcal{X}$上所以的Borel子集的集合<br>$Porb{\mathcal{X}}$ ==&gt; $\mathcal{X}$上的概率密度空间<br>$\mathbb{P}_r,\mathbb{P}_g \in Prob{\mathcal{X}}$</p>
<ul>
<li>Total Variation(TV) distance<script type="math/tex; mode=display">
  \delta\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)=\sup _{A \in \Sigma}\left|\mathbb{P}_{r}(A)-\mathbb{P}_{g}(A)\right|</script></li>
<li>Kullback-Leibler(KL) divergence<script type="math/tex; mode=display">
  K L\left(\mathbb{P}_{r} \| \mathbb{P}_{g}\right)=\int \log \left(\frac{P_{r}(x)}{P_{g}(x)}\right) P_{r}(x) d \mu(x)</script>  $\mathbb{P}_r,\mathbb{P}_g$假设是绝对连续的，且概率密度函数存在，服从统一测度。$P_{g}(x)=0$和$P_{r}(x)&gt;0$时，KL散度时非对称的并且可能为无限值</li>
<li>Jensen-Shannon(JS) divergence<script type="math/tex; mode=display">
  J S\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)=K L\left(\mathbb{P}_{r} \| \mathbb{P}_{m}\right)+K L\left(\mathbb{P}_{g} \| \mathbb{P}_{m}\right)</script>  其中$\mathbb{P}_m = (\mathbb{P}_r + \mathbb{P}_g)/2$,JS散度时对称的，并且可被定义($\mu = \mathbb{P}_m$)</li>
<li>Earth-Mover(EM) distance(Wasserstein-1)<script type="math/tex; mode=display">
  W\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)=\inf _{\gamma \in \Pi\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)} \mathbb{E}_{(x, y) \sim \gamma}[\|x-y\|]</script>  $\Pi\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)$ ==&gt; 边界分别为$\mathbb{P}_r$和$\mathbb{P}_g$的联合分布$\gamma(x,y)$<br>  <strong>直观理解</strong>：$\gamma(x,y)$表示必须从$x$到$y$运输多少质量，才能将分布$\mathbb{P}_r$转换为$\mathbb{P}_g$。EM距离就是最佳传输计划的“成本”。从生成样本和真实样本中随机取出一对样本，计算他们之间的差的均值，最小的那个均值即所求。</li>
</ul>
<p><strong>简单明了的例子(学习平行线)</strong>——概率分布的序列，在EM下收敛，其他下不收敛<br>令 $Z \sim U[0,1]$,$\mathbb{P}_{0}$ be the distribution of $(0, Z) \in \mathbb{R}^{2}$, $g_{\theta}(z)=(\theta, z)$ with $\theta$ a single real parameter</p>
<script type="math/tex; mode=display">
\begin{aligned}
&W\left(\mathbb{P}_{0}, \mathbb{P}_{\theta}\right)=|\theta|\\
&J S\left(\mathbb{P}_{0}, \mathbb{P}_{\theta}\right)=\left\{\begin{array}{ll}
{\log 2} & {\text { if } \theta \neq 0} \\
{0} & {\text { if } \theta=0}
\end{array}\right.\\
&K L\left(\mathbb{P}_{\theta} \| \mathbb{P}_{0}\right)=K L\left(\mathbb{P}_{0} \| \mathbb{P}_{\theta}\right)=\left\{\begin{array}{ll}
{+\infty} & {\text { if } \theta \neq 0} \\
{0} & {\text { if } \theta=0}
\end{array}\right.\\
&\text { and } \delta\left(\mathbb{P}_{0}, \mathbb{P}_{\theta}\right)=\left\{\begin{array}{ll}
{1} & {\text { if } \theta \neq 0} \\
{0} & {\text { if } \theta=0}
\end{array}\right.
\end{aligned}</script><p>当$\theta_t \rightarrow 0$,只有EM距离下序列$(\mathbb{P}_{\theta_t})_{t \in M}$收敛到$\mathbb{P}_0$</p>
<ul>
<li><p><strong>定理1</strong>：已知$\mathbb{P}_r$是空间$\mathcal{X}$上的固定分布，令$Z$为$\mathcal{Z}$空间上的随机变量(e.g. Gaussion)。令$g: \mathcal{Z} \times \mathbb{R}^{d} \rightarrow \mathcal{X}$是一个由$\theta$和$z$确定的函数$g_\theta (z)$,$\mathbb{P}_\theta$代表其分布，那么</p>
<ul>
<li>如果$g$在$\theta$上连续，$W(\mathbb{P}_r,\mathbb{P}_\theta$也连续</li>
<li>如果满足<strong>假设1</strong>，且$g$为Lipschitz函数，那么$W(\mathbb{P}_r,\mathbb{P}_\theta$处处连续且可谓</li>
<li><p>$JS(\mathbb{P}_r,\mathbb{P}_\theta)$和 all the KLs不满足上述性质</p>
<p><strong>证明</strong>：</p>
</li>
</ul>
</li>
<li><p><strong>假设1</strong>：$g: \mathcal{Z} \times \mathbb{R}^{d} \rightarrow \mathcal{X}$是有限维空间中的局部Lipschitz函数，$g_\theta (z)$表示对于坐标$(z,\theta)$的求值。如果存在局部Lipschitz常数$L(\theta, z)$,使得$g$对于$\mathcal{Z}$上的某个概率分布$p$满足</p>
<script type="math/tex; mode=display">
\mathbb{E}_{z \sim p}[L(\theta, z)]<+\infty</script></li>
<li><p><strong>推论1</strong>：令$g_\theta$是关于参数$\theta$的任意的前向传播NN(feedforward neural network)，$p(z)$是当z满足$\mathbb{E}_{z \sim p(z)}[|z|]&lt;\infty$的先验概率。然后满足<strong>假设1</strong>，因此$W(\mathbb{P}_r,\mathbb{P}_\theta)$处处连续且可微<br><strong>证明</strong>：</p>
</li>
</ul>
<p>下面定理描述着由这些距离与离散所引起的相对强度，KL最强，接着是JS与TV，EM最弱。</p>
<ul>
<li><p><strong>定理2</strong>：令$\mathbb{P}$是一个在紧空间$\mathcal{X}$上的分布，$(\mathbb{P}_n)_{n \in N}$是空间$\mathcal{X}$上的一个序列。然后考虑$n \rightarrow \infty$时</p>
<ol>
<li>以下陈述为等价陈述<ul>
<li>$\delta(\mathbb{P}_n, \mathbb{P}) \rightarrow 0$ 其中$\delta$为the total variation distance.</li>
<li>$JS(\mathbb{P}_n, \mathbb{P}) \rightarrow 0$ 其中$JS$为 the Jensen-Shannon divergence.</li>
</ul>
</li>
<li>以下陈述为等价陈述<ul>
<li>$W(\mathbb{P}_n, \mathbb{P}) \rightarrow 0$</li>
<li>$\mathbb{P}_n \stackrel{\mathcal{D}}{\longrightarrow}$其中$\stackrel{\mathcal{D}}{\longrightarrow}\mathbb{P}$表示随机变量的分布收敛性</li>
</ul>
</li>
<li>$K L\left(\mathbb{P}_{n} | \mathbb{P}\right) \rightarrow 0$ 和 $K L\left(\mathbb{P} | \mathbb{P}_{n}\right) \rightarrow 0$满足上述陈述1</li>
<li><p>陈述(1)暗示着陈述(2)</p>
<p><strong>证明</strong>：</p>
</li>
</ol>
</li>
</ul>
<p><strong>定理2</strong>说明了即优化后的$W(\mathbb{P}_n, \mathbb{P})$可能比$JS(\mathbb{P}_n, \mathbb{P})$具有更好的特性<br><strong>结论</strong>：<br>在学习由低维流形支持的分布时，KL，JS和TV距离不是明智的成本函数。 但是，在该设置中，EM距离是明智的。</p>
<h2><span id="14-wasserstein-gan">1.4. Wasserstein GAN</span></h2><p>$W\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)=\inf _{\gamma \in \Pi\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)} \mathbb{E}_{(x, y) \sim \gamma}[|x-y|]$下确界不易计算。改用</p>
<script type="math/tex; mode=display">
W\left(\mathbb{P}_{r}, \mathbb{P}_{\theta}\right)=\sup _{\|  L_{L} \|\leq 1} \mathbb{E}_{x \sim \mathbb{P}_{r}}[f(x)]-\mathbb{E}_{x \sim \mathbb{P}_{\theta}}[f(x)]</script><p>其中上确界覆盖所有的1-Lipschitz functions $f: \mathcal{X} \rightarrow \mathbb{R}$<br>如果使用$|f|_{L} \leq K$替换为$|f|_{L} \leq 1$那么最终得到的为$K \cdot W\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)$((考虑K-Lipschitz为某一个常数K))<br>如果我们有一个参数化的函数族$\left\{f_{w}\right\}_w \in \mathcal{W}$(某些K的K-Lipschitz),那么将问题转化为解决</p>
<script type="math/tex; mode=display">
\max _{w \in \mathcal{W}} \mathbb{E}_{x \sim \mathbb{P}_{r}}\left[f_{w}(x)\right]-\mathbb{E}_{z \sim p(z)}\left[f_{w}\left(g_{\theta}(z)\right]\right.</script><p>如果在上上式中达到上确界$w \in \mathcal{W}$(一个很强的假设，类似于证明估计量的一致性时所假设的假设),则此过程将产生$W\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)$的计算，直到乘法 不变。 此外，我们可以考虑通过估计$\mathbb{E}_{z \sim p(z)}\left[\nabla_{\theta} f_{w}\left(g_{\theta}(z)\right)\right]$通过上式反向传播来对$W\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)$进行微分（再次，直到一个常数）] 尽管这都是直觉，但我们现在证明该过程是在最佳假设下进行的。</p>
<ul>
<li><strong>定理</strong>：令$\mathbb{P}_r$是任意分布，$\mathbb{P}_\theta$是$g_\theta(Z)$的分布，$Z$为带有密度$p$的随机变量，$g_\theta$是满足$W\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)=\inf _{\gamma \in \Pi\left(\mathbb{P}_{r}, \mathbb{P}_{g}\right)} \mathbb{E}_{(x, y) \sim \gamma}[|x-y|]$的函数。那么，有一个解决这问题的方法<script type="math/tex; mode=display">
\max _{\|f\|_{L} \leq 1} \mathbb{E}_{x \sim \mathbb{P}_{r}}[f(x)]-\mathbb{E}_{x \sim \mathbb{P}_{\theta}}[f(x)]</script>当两个函数都有明确定义时<script type="math/tex; mode=display">
\nabla_{\theta} W\left(\mathbb{P}_{r}, \mathbb{P}_{\theta}\right)=-\mathbb{E}_{z \sim p(z)}\left[\nabla_{\theta} f\left(g_{\theta}(z)\right)\right]</script><strong>证明</strong>：</li>
</ul>
<p>问题就变成了找到一个满足利普西兹函数条件的函数$f$，使得达到最大值。可以用带参数的$w$神经网络确定函数，为使函数满足利普西兹条件，可以简单地将其参数截断到一个范围（比较简单）。$f_w$被称为critic，生成模型的梯度传播为$\mathbb{E}_{z \sim p(z)}\left[\nabla_{\theta} f_{w}\left(g_{\theta}(z)\right)\right]$</p>
<p>用权重剪裁(clipping)来强制Lipschitz约束是一种明显糟糕的方法。如果剪裁(clipping)参数过大，那们每一个权重都需要花费很长的时间才能到达它们的极值，从而造成训练critic最佳化非常困难。如果剪裁(clipping)参数过小，那在神经网路很深或没有使用batch normalization(像是RNNs)的情况下，它会很轻易的导致梯度消失(vanishing gradients)。我们尝试简单的变体(像是将权重(weights)投射到球面(sphere) )，差异很小，并且由于它的简单性和良好的效能，我们坚持使用权重剪裁(weight clipping)。然而，我们确实将强制Lipschitz约束的主题保留在神经网路设置中供进一步研究，我们积极鼓励感兴趣的研究人员来改进这个方法。</p>
<p><img src="https://image.zkhweb.top/20200213234842.png" alt="20200213234842.png"></p>
<p>EM距离是连续且可微。意味着我们可以（并且应该）训练critic一直到最佳性。<br>训练critic愈多，将得到的Wasserstein梯度就愈可靠<br>因为Wasserstein几乎处处可微。</p>
<p>对于JS-divergence，即使discriminator得到更好的梯度，也更可靠，但是险际上它的梯度是0，因为JS是局部饱合的(locally saturated)，我们得到消失的梯度</p>
<p>也许更重要的是，当我们这样做的时候，事实上我们可以训练critic一直到最佳性，这确保训练过程不会坏掉。坏掉的一个原因事实在于，固定discriminator的最佳generator是分配最高值的点上的增量总和。</p>
<h2><span id="15-实验结果">1.5. 实验结果</span></h2><ul>
<li>说明这是一个有效的损失度量，和生成模型的收敛以及样本质量有关。</li>
<li>提高了优化过程的稳定性。</li>
</ul>
<h1><span id="2-总结">2. 总结</span></h1><p>引入一种算法，我们认为WGAN可以替代传统GAN的训练。在这个新的模型中，我们说明我们可以提高学习稳定性，摆掉脱一些问题，像是mode collapse，并提供有意义的学习曲线来帮助除错与超参数的寻找。此外，我们说明相关优化问题是合理的，并提供广泛的理论工作来强调分布之间其它距离的深度连结。</p>
<hr>
<h1><span id="3-参考资料">3. 参考资料</span></h1><p><a href="http://arxiv.org/abs/1701.07875" target="_blank" rel="noopener">Paper—-Wasserstein GAN</a><br><a href="https://blog.csdn.net/xiaohouzi1992/article/details/80854086" target="_blank" rel="noopener">CSDN—-Wasserstein GANs 三部曲（二）:Wasserstein GAN论文的理解</a><br><a href="https://blog.csdn.net/shanlepu6038/article/details/86539216" target="_blank" rel="noopener">CSDN—-WGAN-GP精彩分析（附源代码）</a><br><a href="https://blog.csdn.net/duanmuji/article/details/87937505" target="_blank" rel="noopener">CSDN—-WGAN, WGAN-GP, BE-GAN论文笔记</a><br><a href="https://blog.csdn.net/qq_31239495/article/details/83145651" target="_blank" rel="noopener">CSDN—-WGAN(wasserstein GAN)</a><br><a href="https://blog.csdn.net/zh20166666/article/details/83444089" target="_blank" rel="noopener">CSDN—-论文阅读——《Wasserstein GAN》《Improved Training of Wasserstein GANs》</a><br><a href="https://zhuanlan.zhihu.com/p/25071913" target="_blank" rel="noopener">知乎—-令人拍案叫绝的Wasserstein GAN</a><br><a href="https://hackmd.io/@shaoeChen/SyjI6W2zB/https%3A%2F%2Fhackmd.io%2F%40shaoeChen%2FryT0HZtXr" target="_blank" rel="noopener">个人Blog—-WGAN_Paper(翻譯)</a><br><a href="http://www.twistedwg.com/2018/01/31/WGAN.html" target="_blank" rel="noopener">个人Blog—-WGAN介绍</a></p>

                    </article>
                    
    <blockquote class="post-license">
        <p>
            <strong>本文作者&nbsp;:&nbsp;幻华(Zkher)</strong>
            <br>
            <strong>
            
                本文使用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)</a> 协议
            </strong>
            <br>
            <strong>本文链接&nbsp;:&nbsp;</strong><a href="http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/">http://www.zkhweb.top/2020/02/24/2017-Wasserstein-GAN/</a>
        </p>
    </blockquote>



    <blockquote id="date-expire-notification" class="post-expired-notify">本文最后更新于 <span id="date-expire-num"></span> 天前，文中所描述的信息可能已发生改变</blockquote>
    <script>
        var dateUpdate = Date.parse("2020-03-01");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    </script>


<p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2020-02-24T12:43:09.000Z" itemprop="datePublished">2020-02-24</time>

    , 最后修改于&nbsp;<time datetime="2020-03-01T13:59:41.964Z" itemprop="dateModified">2020-03-01</time>

</p>
<p class="post-footer-info mb-0 pt-2">

<span class="post-categories-list mt-2">


<a class="post-categories-list-item" href="/categories/深度学习论文阅读/">深度学习论文阅读</a>

</span>



<span class="post-tags-list mt-2">


<a class="post-tags-list-item" href="/tags/深度学习/">#&nbsp;深度学习</a>

<a class="post-tags-list-item" href="/tags/论文阅读/">#&nbsp;论文阅读</a>

</span>


</p>

                </div>
                
<div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2020/05/01/bookmarklet/bookmarklet 发布/">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">常用小书签(bookmarklet)</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2020/02/17/2017-Towards-Principled-Methods-for-Training-Generative-Adversarial-Networks论文阅读/">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">Towards Principled Methods for Training Generative Adversarial Networks论文阅读</div>
            </a>
        </li>
    
</ul>
</div>

                
                    <!-- # Comment # -->
                    
                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span data-year></span>
        <a class="footer-copyright-a" href="http://www.zkhweb.top">幻华&#39;s Blog</a>
        <a target="_blank" class="footer-develop-a">&nbsp;|</a>
        <img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png">
        <a href="http://www.beian.miit.gov.cn/" style="color:#f72b07" target="_blank">京ICP备18049834号</a>
    </p>
    
    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
            
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>


    <!-- Busuanzi Post Views -->
    <span id="busuanzi_container_site_pv" hidden>
        <span></span>
        <span id="busuanzi_value_site_pv"></span>
        <span>Views</span>
        
    </span>


        
        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="noopener">Suka</a>
    </p>
</footer>

        

        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};



    /* Copyright */
    var copyrightNow = new Date().getFullYear();
    var copyrightContent = document.querySelector('span[data-year]')
    
        copyrightContent.textContent = copyrightNow
    



/* Cnosole Log */
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.2 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');
</script>

<!-- vanilla-lazyload -->

    <script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>



    <!-- Busuanzi -->
    
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->







<!-- gallery.js -->


<!-- Comment -->


<!-- ### Custom Footer ### --><!-- hexo-inject:begin --><!-- hexo-inject:end -->


    </body>

</html>